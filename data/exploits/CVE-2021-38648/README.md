# CVE-2021-38648 Microsoft OMI Management Interface Authentication Bypass
This is an LPE exploit for CVE-2021-38648

## Usage

```
usage: exploit.py [-h] [-s SOCKET_PATH] command

positional arguments:
  command               the command to run

optional arguments:
  -h, --help            show this help message and exit
  -s SOCKET_PATH, --socket SOCKET_PATH
                        socket file
```

The exploit will exit with a status of 0 on success. The command is limited to 256 characters in length due to the
hardcoded messages that are exchanged.

The hardcoded messages were recovered using:
```
strace -v -s 5000 -f -xx -e trace=socket,connect,write,writev,close \
  /opt/omi/bin/omicli iv root/scx { SCX_OperatingSystem } ExecuteShellCommand { command '...' timeout 0 }
```
