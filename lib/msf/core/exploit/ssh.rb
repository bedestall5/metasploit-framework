# -*- coding: binary -*-

module Msf::Exploit::Remote::SSH

  # Require most things so that modules using this will "just work"
  require 'net/ssh'
  require 'net/ssh/command_stream'
  require 'rex/socket/ssh_factory'
  require 'msf/core/exploit/ssh/options'
  require 'msf/core/exploit/ssh/auth_methods'

  # Register SSH datastore options:
  #   SSHVersion
  #   SSH_TIMEOUT (TODO: Refactor to SSHTimeout)
  #   SSH_DEBUG   (TODO: Refactor to SSHDebug)
  include Msf::Exploit::Remote::SSH::Options

  # Patch in our custom auth methods:
  #   malformed-packet
  #   fortinet-backdoor
  include Msf::Exploit::Remote::SSH::AuthMethods

  def ssh_socket_factory
    Rex::Socket::SSHFactory.new(framework, self, datastore['Proxies'])
  end

end
