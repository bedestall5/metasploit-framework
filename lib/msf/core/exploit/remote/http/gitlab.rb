# -*- coding: binary -*-

module Msf
  class Exploit
    class Remote
      module HTTP
        # This module provides a way of interacting with gitlab installations
        module Gitlab
          include Msf::Exploit::Remote::HttpClient
          include Msf::Exploit::Remote::HTTP::Gitlab::AccessTokens
          include Msf::Exploit::Remote::HTTP::Gitlab::Groups
          include Msf::Exploit::Remote::HTTP::Gitlab::Helpers
          include Msf::Exploit::Remote::HTTP::Gitlab::Import
          include Msf::Exploit::Remote::HTTP::Gitlab::Signin
          include Msf::Exploit::Remote::HTTP::Gitlab::Version
          # include Msf::Exploit::Remote::HTTP::Gitlab::Api

          def initialize(info = {})
            super

            register_options(
              [
                Msf::OptString.new('TARGETURI', [true, 'The base path to the gitlab application', '/'])
              ], Msf::Exploit::Remote::HTTP::Gitlab
            )

            # register_advanced_options(
            #   [
            #     Msf::OptString.new('WPCONTENTDIR', [true, 'The name of the wp-content directory', 'wp-content']),
            #     Msf::OptBool.new('WPCHECK', [true, 'Check if the website is a valid WordPress install', true]),
            #   ], Msf::Exploit::Remote::HTTP::Gitlab
            # )
          end

          class GitLabClientException < StandardError; end
        end
      end
    end
  end
end
