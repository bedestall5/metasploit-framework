module Msf
  class Exploit
    class Remote
      module HTTP
        # This module provides a way of interacting with ManageEngine ADAudit Plus installations
        module ManageengineAdauditPlus
          SUCCESS = 0
          CONNECTION_FAILED = 1
          UNEXPECTED_REPLY = 2
          NO_MATCH = 3
          NO_ACCESS = 4
          include Msf::Exploit::Remote::HttpClient
          include Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus::Login
          include Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus::JsonPostData
          include Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus::TargetInfo
          include Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus::URIs

          def initialize(info = {})
            super

            register_options(
              [
                Msf::OptString.new('TARGETURI', [true, 'The base path to the ManageEnginge ADAudit Plus application', '/']),
                Msf::OptString.new('USERNAME', [false, 'Username to authenticate with', 'admin']),
                Msf::OptString.new('PASSWORD', [false, 'Password to authenticate with', 'admin']),

              ], Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus
            )
          end

          def adaudit_plus_status
            Msf::Exploit::Remote::HTTP::ManageengineAdauditPlus
          end
        end
      end
    end
  end
end
