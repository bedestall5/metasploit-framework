
module Msf
module Exploit::Local::Unix
	attr_accessor :cpu
	attr_accessor :cparser

	def setup
		super
		init_metasm(Metasm::Ia32.new)
	end

	def init_metasm(cpu, cparser=nil)
		@cpu = cpu
		@cparser = cparser || cpu.new_cparser
	end

	def include_socket_h
		cparser.parse <<-EOC
			#define PF_BLUETOOTH 31
			#define PF_IUCV 32

			#define IPPROTO_SCTP 132

			#define SOCK_STREAM 1
			#define SOCK_DGRAM 2
			#define SOCK_SEQPACKET 5

			struct iovec {
				char *iov_base;
				int  iov_len;
			};

		EOC

		nil
	end


end
end

