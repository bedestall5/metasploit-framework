#
#   Time-Based Blind SQL injection support for MySQL
#
class Msf::Exploit::SQLi::MySQLi::TimeBasedBlind < Msf::Exploit::SQLi::MySQLi
  def initialize(opts, &query_proc)
    opts[:sleepdelay] ||= 5
    opts[:sleepfunc] ||= :sleep
    @sleepdelay = opts[:sleepdelay]
    @sleepfunc = opts[:sleepfunc]
    super
  end

  def run_sql(query)
    # TODO
  end

  private

  def check_opts(opts)
    # check if opts contains what it should contain
    required_opts = %w[sleepdelay sleepfunc]
    missing_opt = required_opts.detect { |opt| !opts[opt] }
    raise ArgumentError, "missing option #{missing_opt}" if missing_opt

    super
  end
end
