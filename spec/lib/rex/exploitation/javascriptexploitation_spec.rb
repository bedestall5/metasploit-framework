require 'rex/exploitation/javascriptexploitation'

describe Rex::Exploitation::JavascriptExploitation do

  context "Class methods" do

    context ".mstime_malloc" do
      it "should load the mstime_malloc javascript" do
        js = Rex::Exploitation::JavascriptExploitation.mstime_malloc
        js.should =~ /function mstime_malloc/
      end
    end

    context ".property_spray" do
      it "should load the property_spray javascript" do
        js = Rex::Exploitation::JavascriptExploitation.property_spray
        js.should =~ /function sprayHeap/
      end
    end

    context ".heap_spray" do
      it "should load the heap_spray javascript" do
        js = Rex::Exploitation::JavascriptExploitation.heap_spray
        js.should =~ /function sprayHeap/
      end
    end

  end

end