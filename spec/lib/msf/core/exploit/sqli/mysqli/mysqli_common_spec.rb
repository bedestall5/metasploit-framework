RSpec.describe Msf::Exploit::SQLi::MySQLi::Common do
  it 'Should replace strings with their hex encoding valid in MySQL' do
    query = "select concat('password is ', password) from users where username='admin' limit 1"
    encoded_query = 'select concat(0x70617373776f726420697320, password) from users where username=0x61646d696e limit 1'
    sqli_obj = Msf::Exploit::SQLi::MySQLi::Common.new({}, {}, {}) {}
    expect(sqli_obj.send(:hex_encode_strings, query)).to eql encoded_query
  end
  it_should_behave_like 'Msf::Exploit::SQLi::Common', described_class
end
