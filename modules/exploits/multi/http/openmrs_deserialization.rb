##
# This module requires Metasploit: https://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = NormalRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(update_info(info,
      'Name'           => 'OpenMRS Java Deserialization RCE',
      'Description'    => %q(
      ),
      'License'        => MSF_LICENSE,
      'Author'         =>
      [
        'Nicola Serra', # Vuln Discovery and PoC
        'mpgn',         # PoC
        'Shelby Pace'   # Metasploit Module
      ],
      'References'     =>
       [
         [ 'CVE', '2018-19276' ],
         [ 'URL', 'https://talk.openmrs.org/t/critical-security-advisory-cve-2018-19276-2019-02-04/21607' ],
         [ 'URL', 'https://github.com/mpgn/CVE-2018-19276/' ]
       ],
      'Payload'        => { },
      'Targets'        =>
       [
        [ '', { } ]
       ],
      'DisclosureDate' => "Apr 1 2013",
      'DefaultTarget'  => 0
    ))

    register_options(
    [
        OptString.new('TARGETURI', [ true, 'Base URI for OpenMRS', '/' ])
    ])
  end

  def check
  end

  def exploit
  end
end
